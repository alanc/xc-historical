#define IHaveSubdirs
#define PassCDebugFlags

#if MakeContributed
CONTRIBDIRS = $(CONTRIBSRC)
#endif

#
# Preserve this order: include comes first, clients, demos, contrib come last.
#
     DIRSTOMAKE = \
		$(INCLUDESRC) \
		$(LIBSRC) \
		$(SERVERSRC) \
		$(FONTSRC) \
		$(EXTENSIONSRC) \
		$(CLIENTSRC) \
		$(DEMOSRC) \
		$(EXAMPLESRC) \
		$(CONTRIBDIRS)
        SUBDIRS = \
		$(DIRSTOMAKE) \
		$(UTILSRC) \
		$(XMANSRC)
    LINTLIBDIRS = \
		$(EXTENSIONSRC) \
		$(LIBSRC)

MakeSubdirs($(DIRSTOMAKE) $(RGBSRC) $(XMANSRC))
MakeLintLibSubdirs($(LINTLIBDIRS))

#
# before doing the depend, be sure that makedepend exists, and that
# the include directory has everything in it.
#
depend::
	cd include; $(MAKE)

depend:: $(DEPEND)

$(DEPEND):
	@echo "making $(DEPENDSRC)"; \
	cd $(DEPENDSRC); $(MAKE)

DependSubdirs($(SUBDIRS))

install::
	-mkdir $(USRLIBDIR)
	-mkdir $(BINDIR)
	-mkdir $(LIBDIR)
	-mkdir $(INCDIR)
	-mkdir $(FONTDIR)
	-mkdir $(MANDIR)
	-$(LN) $(INCDIR) $(FUTUREINCDIR)

#
# before making the makefiles, be sure that imake exists.
#
Makefiles:: $(IMAKE)

Makefile:: $(IMAKE)

$(IMAKE):
	@echo "making $(IMAKESRC)"; \
	cd $(IMAKESRC); $(MAKE)

# don't name your log file make.log when you run this ...
World: $(IMAKE)
	-$(MV) Makefile Makefile.bak
	$(MAKE) -f Makefile.bak Makefile
	$(MAKE) Makefiles
	$(MAKE) clean
	$(MAKE) depend
	$(MAKE) -k
